<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Vitaliy Zasadnyy</title>
    <description>Hi, my name is Vitaliy, I&#39;m mobile developer and Google Developers Group Lviv co-founder. I&#39;m interested in GameDev, Android, iOS, Google App Engine and community management. Used to work for enterprise giants like EPAM as well as for product companies such as NRavo.</description>
    <link>http://zasadnyy-inc.github.io/personal-site/</link>
    <atom:link href="http://zasadnyy-inc.github.io/personal-site/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Fri, 05 Dec 2014 13:25:40 +0200</pubDate>
    <lastBuildDate>Fri, 05 Dec 2014 13:25:40 +0200</lastBuildDate>
    <generator>Jekyll v2.5.2</generator>
    
      <item>
        <title>Test123</title>
        <description>
</description>
        <pubDate>Mon, 17 Nov 2014 23:52:14 +0200</pubDate>
        <link>http://zasadnyy-inc.github.io/personal-site/blog/test123</link>
        <guid isPermaLink="true">http://zasadnyy-inc.github.io/personal-site/blog/test123</guid>
        
        
      </item>
    
      <item>
        <title>Happy birthday!</title>
        <description>&lt;p&gt;&lt;img class=&quot;img-responsive&quot; src=&quot;/personal-site/img/vitaliy/posts/happy_birthday.jpg&quot; alt=&quot;Happy birthday!&quot; /&gt;
Happy birthday my brother!&lt;/p&gt;

&lt;p&gt;I wish you mad love, success in work, interesting projects and best friends.&lt;/p&gt;

&lt;p&gt;Made for you a small gift - your personal site. I hope you will enjoy it.
Thank you for your support and helping me in all situations.&lt;/p&gt;

</description>
        <pubDate>Wed, 12 Nov 2014 02:01:00 +0200</pubDate>
        <link>http://zasadnyy-inc.github.io/personal-site/blog/happy-birthday</link>
        <guid isPermaLink="true">http://zasadnyy-inc.github.io/personal-site/blog/happy-birthday</guid>
        
        
        <category>dates</category>
        
        <category>birthday</category>
        
        <category>happy</category>
        
      </item>
    
      <item>
        <title>Action Bar Sherlock, Maven, eclipse integration</title>
        <description>&lt;p&gt;&lt;img src=&quot;http://1.bp.blogspot.com/-N2LE51GMJNU/UJZtsJQiviI/AAAAAAAAEFk/p5_YM_10pqU/s1600/eclipse-maven-abs.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Hello, today I’d like to describe process of integration commonly used library for emulation action bar in old Android versions - &lt;a href=&quot;http://actionbarsherlock.com/&quot;&gt;ActionBarSherlock&lt;/a&gt; into maven - eclipse project.
In a result we’ll get project with:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;support of Action Bar Sherlock&lt;/li&gt;
  &lt;li&gt;support of integration tests as a separate project&lt;/li&gt;
  &lt;li&gt;configured maven build and release targets&lt;/li&gt;
  &lt;li&gt;configured eclipse for develop and debug&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This is my first post, so don’t be too critical :)&lt;/p&gt;

&lt;p&gt;At first lets create empty Android mvn project. In order to compleate this steap we’ll need:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.oracle.com/technetwork/java/javase/downloads/jdk7u9-downloads-1859576.html&quot;&gt;JDK 1.6+&lt;/a&gt;installed as required for Android development&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://developer.android.com/intl/ru/sdk/index.html&quot;&gt;Android SDK&lt;/a&gt; installed r17+ , preferably with all platforms&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://maven.apache.org/download.html&quot;&gt;Maven 3.0.3+&lt;/a&gt; installed&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;If you’ll use eclipse for a development, you’ll also need:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;eclipse with &lt;a href=&quot;http://eclipse.org/m2e/&quot;&gt;m2e&lt;/a&gt; plugin installed&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;At first lets create android project using akquinet &lt;a href=&quot;https://github.com/akquinet/android-archetypes&quot;&gt;android-archetypes&lt;/a&gt;. In result we’ll get sample project with configured release targets and integration tests project. Copy to terminal following code, replacing highligted lines with your values:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;mvn archetype:generate \
 -DarchetypeArtifactId=android-release \
 -DarchetypeGroupId=de.akquinet.android.archetypes \
 -DarchetypeVersion=1.0.8 \
 -DgroupId=com.foo.bar \
 -DartifactId=my-android-project \
 -Dpackage=com.foo.bar.test \
 -Dplatform=16&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Once generated, the application is ready to be built and tested. Start an android emulator, or plug an Android dev phone, and execute:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cd my-android-project
mvn clean install&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Besides your application this commands will also install and execute integrations tests application.&lt;/p&gt;

&lt;p&gt;Generated project goes with test keystore that could be used for test, but not for deploying to market, execute this command to get signed apk:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;mvn clean install -Prelease \
-Dsign.keystore=PATH_OF_THE_PROJECT/my-android-project/test-key.keystore \
-Dsign.alias=mykey \
-Dsign.storepass=testtest \
-Dsign.keypass=testtest&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now we need to download and add to our project dependencies &lt;a href=&quot;http://actionbarsherlock.com/&quot;&gt;ActionbarBarSherlock&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Latest version of the library always is available in project &lt;a href=&quot;http://actionbarsherlock.com/download.html&quot;&gt;download page&lt;/a&gt;. When it’s ready, unzip archive, copy &lt;code&gt;library&lt;/code&gt; folder to your project root and rename it to &lt;code&gt;actionbarsherlock&lt;/code&gt;:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://3.bp.blogspot.com/-xcB5pGCi7dY/UJZ_tfwiHhI/AAAAAAAAEGY/CMAXMVj8vCU/s1600/skitch+(6).png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As it is stated on &lt;a href=&quot;http://actionbarsherlock.com/usage.html&quot;&gt;abs usage page&lt;/a&gt; the only thing we need - is to add this lines to &lt;code&gt;my-android-project/my-android-project/pom.xml&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-xml&quot; data-lang=&quot;xml&quot;&gt;&amp;lt;dependency&amp;gt;
  &amp;lt;groupId&amp;gt;com.actionbarsherlock&amp;lt;/groupId&amp;gt;
  &amp;lt;artifactId&amp;gt;actionbarsherlock&amp;lt;/artifactId&amp;gt;
  &amp;lt;version&amp;gt;4.2.0&amp;lt;/version&amp;gt;
  &amp;lt;type&amp;gt;apklib&amp;lt;/type&amp;gt;
&amp;lt;/dependency&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Also you need to extend &lt;code&gt;HelloAndroidActivity&lt;/code&gt; from &lt;code&gt;com.actionbarsherlock.app.SherlockActivity&lt;/code&gt; instead of &lt;code&gt;android.app.Activity&lt;/code&gt; and change activity theme in &lt;code&gt;AndroidManifest.xml&lt;/code&gt; to &lt;code&gt;android:theme=&quot;@style/Theme.Sherlock&quot;&lt;/code&gt;. Checkout &lt;a href=&quot;https://dl.dropbox.com/u/7656932/blog/action_bar_sherlock_mvn_integration/patch.diff&quot;&gt;git patch file&lt;/a&gt; for details. Try to build app. From parent project folder execute:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;mvn clean install&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;You’ll get following error: &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;[INFO] UNEXPECTED TOP-LEVEL EXCEPTION:
[INFO] java.lang.IllegalArgumentException: already added: Landroid/support/v4/app/Watson$OnCreateOptionsMenuListener;
[INFO]  at com.android.dx.dex.file.ClassDefsSection.add(ClassDefsSection.java:123)
[INFO]  at com.android.dx.dex.file.DexFile.add(DexFile.java:163)
[INFO]  at com.android.dx.command.dexer.Main.processClass(Main.java:486)
[INFO]  at com.android.dx.command.dexer.Main.processFileBytes(Main.java:455)
[INFO]  at com.android.dx.command.dexer.Main.access$400(Main.java:67)
[INFO]  at com.android.dx.command.dexer.Main$1.processFileBytes(Main.java:394)
[INFO]  at com.android.dx.cf.direct.ClassPathOpener.processArchive(ClassPathOpener.java:245)
[INFO]  at com.android.dx.cf.direct.ClassPathOpener.processOne(ClassPathOpener.java:131)
[INFO]  at com.android.dx.cf.direct.ClassPathOpener.process(ClassPathOpener.java:109)
[INFO]  at com.android.dx.command.dexer.Main.processOne(Main.java:418)
[INFO]  at com.android.dx.command.dexer.Main.processAllFiles(Main.java:329)
[INFO]  at com.android.dx.command.dexer.Main.run(Main.java:206)
[INFO]  at com.android.dx.command.dexer.Main.main(Main.java:174)
[INFO]  at com.android.dx.command.Main.main(Main.java:91)
[INFO] 1 error; aborting
[INFO] ------------------------------------------------------------------------
[INFO] Reactor Summary:
[INFO] 
[INFO] my-android-project - Parent ....................... SUCCESS [0.394s]
[INFO] my-android-project - Application .................. SUCCESS [14.880s]
[INFO] my-android-project-it - Integration tests ......... FAILURE [9.501s]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 21.255s
[INFO] Finished at: Sun Nov 04 12:50:51 GMT+02:00 2012
[INFO] Final Memory: 15M/81M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal com.jayway.maven.plugins.android.generation2:android-maven-plugin:3.1.1:dex (default-dex) on project my-android-project-it: MojoExecutionException: ANDROID-040-001: Could not execute: Command = /bin/sh -c cd /Users/vitaliyzasadnyy/Development/workspaces/blog/my-android-project-parent/my-android-project-it &amp;amp;&amp;amp; /System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home/bin/java -Xmx1024M -jar /Users/vitaliyzasadnyy/Development/SDKs/android-sdk-macosx/platform-tools/lib/dx.jar --dex --output=/Users/vitaliyzasadnyy/Development/workspaces/blog/my-android-project-parent/my-android-project-it/target/classes.dex /Users/vitaliyzasadnyy/.m2/repository/com/actionbarsherlock/actionbarsherlock/4.2.0/actionbarsherlock-4.2.0.apklib /Users/vitaliyzasadnyy/Development/workspaces/blog/my-android-project-parent/my-android-project/target/my-android-project-1.0-SNAPSHOT.jar /Users/vitaliyzasadnyy/Development/workspaces/blog/my-android-project-parent/my-android-project-it/target/classes /Users/vitaliyzasadnyy/.m2/repository/de/akquinet/android/androlog/androlog/1.0.5/androlog-1.0.5.jar /Users/vitaliyzasadnyy/.m2/repository/com/google/android/support-v4/r7/support-v4-r7.jar, Result = 1 -&amp;gt; [Help 1]&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;If you carefully take a look to the last error you’ll notice that problem is with &lt;code&gt;generation2&lt;/code&gt; goal, it uses dex tool from Android SDK to generate class files for Dalvik, during execution it include &lt;code&gt;actionbarsherlock&lt;/code&gt; and &lt;code&gt;support-v4-r7&lt;/code&gt; dependencies two times (second time like transitive dependency from our application project), checkout  it &lt;code&gt;--output&lt;/code&gt; parameter values (here is a bit formatted text from maven error):&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;/System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home/bin/java -Xmx1024M -jar /Users/vitaliyzasadnyy/Development/SDKs/android-sdk-macosx/platform-tools/lib/dx.jar --dex --output=
  /Users/vitaliyzasadnyy/Development/workspaces/blog/my-android-project-parent/my-android-project-it/target/classes.dex 
  /Users/vitaliyzasadnyy/.m2/repository/com/actionbarsherlock/actionbarsherlock/4.2.0/actionbarsherlock-4.2.0.apklib
  /Users/vitaliyzasadnyy/Development/workspaces/blog/my-android-project-parent/my-android-project/target/my-android-project-1.0-SNAPSHOT.jar
  /Users/vitaliyzasadnyy/Development/workspaces/blog/my-android-project-parent/my-android-project-it/target/classes 
  /Users/vitaliyzasadnyy/.m2/repository/de/akquinet/android/androlog/androlog/1.0.5/androlog-1.0.5.jar 
  /Users/vitaliyzasadnyy/.m2/repository/com/google/android/support-v4/r7/support-v4-r7.jar&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;We can fix this error by adding &lt;code&gt;actionbarsherlock&lt;/code&gt; and &lt;code&gt;support-v4-r7&lt;/code&gt; dependencies with scope provided to &lt;code&gt;my-android-project-it/pom.xml&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-xml&quot; data-lang=&quot;xml&quot;&gt;&amp;lt;dependency&amp;gt;
  &amp;lt;groupId&amp;gt;com.google.android&amp;lt;/groupId&amp;gt;
  &amp;lt;artifactId&amp;gt;support-v4&amp;lt;/artifactId&amp;gt;
  &amp;lt;version&amp;gt;r7&amp;lt;/version&amp;gt;
  &amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;
&amp;lt;/dependency&amp;gt;
 
 &amp;lt;dependency&amp;gt;
   &amp;lt;groupId&amp;gt;com.actionbarsherlock&amp;lt;/groupId&amp;gt;
   &amp;lt;artifactId&amp;gt;actionbarsherlock&amp;lt;/artifactId&amp;gt;
   &amp;lt;version&amp;gt;4.2.0&amp;lt;/version&amp;gt;
   &amp;lt;type&amp;gt;apklib&amp;lt;/type&amp;gt;
   &amp;lt;scope&amp;gt;provided&amp;lt;/scope&amp;gt;
&amp;lt;/dependency&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now project should build successfully.&lt;/p&gt;

&lt;p&gt;Next steep is to configurate eclipse. Rename parent folder of a project from &lt;code&gt;my-android-project&lt;/code&gt; to &lt;code&gt;my-android-project-parent&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://3.bp.blogspot.com/-9IbLAQSGEqY/UJZ_4Bich5I/AAAAAAAAEGg/9QX6bdpcIIU/s1600/skitch.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Open eclipse, import &lt;code&gt;my-android-project-parent&lt;/code&gt; using existing maven project wizard. As &lt;code&gt;actionbarsherlock&lt;/code&gt; is not part of our parent maven project you’ll also need to import it as existing maven project (&lt;u&gt;don&#39;t&lt;/u&gt; import it as android library project!). After this steeps you should have following project structure: &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://4.bp.blogspot.com/-ulCNdpZlluo/UJZ_-SFVYMI/AAAAAAAAEGo/SY2tMbavGTE/s1600/skitch+(1).png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Let’s fix build path problems that we have.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Go to &lt;code&gt;my-android-project&lt;/code&gt; properties&lt;/li&gt;
  &lt;li&gt;Open Android section&lt;/li&gt;
  &lt;li&gt;Add &lt;code&gt;actionbarsherlock&lt;/code&gt; as library by pressing Add button&lt;/li&gt;
  &lt;li&gt;Now you should see &lt;code&gt;actionbarsherlock&lt;/code&gt; in library section&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;http://1.bp.blogspot.com/-mpZ-NRhsdqE/UJaAG_IwCYI/AAAAAAAAEGw/5ffRusEUui0/s640/skitch+(2).png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Now all errors form eclipse markers view should disappear and we can run our project. Select &lt;code&gt;my-android-project&lt;/code&gt; and run it as android application…but you’ll get:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://4.bp.blogspot.com/-vxlkSq2PIEk/UJaAZ_gBz1I/AAAAAAAAEHA/FURcJnLm724/s1600/skitch+(4).png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In console view you’ll find error like this one:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;[2012-11-04 14:22:26 - my-android-project] Conversion to Dalvik format failed with error 1
[2012-11-04 14:23:55 - my-android-project] Dx 
UNEXPECTED TOP-LEVEL EXCEPTION:
java.lang.IllegalArgumentException: already added: Lorg/hamcrest/BaseDescription;
[2012-11-04 14:23:55 - my-android-project] Dx  at com.android.dx.dex.file.ClassDefsSection.add(ClassDefsSection.java:123)
[2012-11-04 14:23:55 - my-android-project] Dx  at com.android.dx.dex.file.DexFile.add(DexFile.java:163)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Remember our problem with maven configuration? Here we have quite the same issue with double inclusion. In order to fix it remove libs folder with &lt;code&gt;android-support-v4.jar&lt;/code&gt; from &lt;code&gt;actionbarsherlock&lt;/code&gt; project.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://1.bp.blogspot.com/-o5m_thbuTc4/UJaAhASgRFI/AAAAAAAAEHI/0WCeDz2N55w/s1600/skitch+(5).png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Finally, clean all projects and run &lt;code&gt;my-android-project&lt;/code&gt;. We’ve got working application:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://3.bp.blogspot.com/-iTMxDmqxpfo/UJZxZFI4LAI/AAAAAAAAEF0/zFnvLNiVJJo/s320/device-2012-11-04-154320.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Sample project from post you can &lt;a href=&quot;https://dl.dropbox.com/u/7656932/blog/action_bar_sherlock_mvn_integration/my-android-project-parent.zip&quot;&gt;download here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Hope this post was useful, if you have any notes or propositions how it can be improved, please write a comment.&lt;/p&gt;
</description>
        <pubDate>Sun, 04 Nov 2012 02:01:00 +0200</pubDate>
        <link>http://zasadnyy-inc.github.io/personal-site/blog/abs-maven-eclipse-integration</link>
        <guid isPermaLink="true">http://zasadnyy-inc.github.io/personal-site/blog/abs-maven-eclipse-integration</guid>
        
        
        <category>android</category>
        
      </item>
    
  </channel>
</rss>
